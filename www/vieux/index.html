<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' data: gap: https://ssl.gstatic.com https://cdn.sheetjs.com 'unsafe-eval' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; media-src *; img-src 'self' data: content:;">
    
    <title>Chrono Race Pro</title>
    <link rel="stylesheet" href="css/index.css">
</head>
<body>
    <div class="app">
        <!-- En-tÃªte -->
        <header>
            <h1>â±ï¸ Chrono Race Pro</h1>
            <p id="label-mode" style="margin-top: 10px; font-size: 18px; opacity: 0.9;">Multi-coureurs avec dÃ©parts sÃ©parÃ©s</p>
        </header>

        <!-- SÃ©lection du mode d'application -->
        <div class="mode-app-section">
            <h2>ğŸ“± Mode de fonctionnement</h2>
            <div class="mode-app-switch">
                <button id="btn-mode-local" class="mode-app-btn active">ğŸ  LOCAL<br><small>1 tÃ©lÃ©phone</small></button>
                <button id="btn-mode-depart" class="mode-app-btn">ğŸš€ DÃ‰PART<br><small>TÃ©lÃ©phone 1</small></button>
                <button id="btn-mode-arrivee" class="mode-app-btn">ğŸ ARRIVÃ‰E<br><small>TÃ©lÃ©phone 2</small></button>
            </div>
            
            <!-- Aide contextuelle -->
            <div id="mode-help" style="margin-top: 15px; padding: 15px; background: rgba(255, 215, 0, 0.1); border: 2px solid #FFD700; border-radius: 15px;">
                <p id="help-text" style="color: #FFD700; font-size: 16px; line-height: 1.6; margin: 0;">
                    <strong>MODE LOCAL :</strong> ChronomÃ©trez avec 1 seul tÃ©lÃ©phone. DÃ©parts et arrivÃ©es sur le mÃªme appareil.
                </p>
            </div>
            
            <!-- Configuration SMS (visible en mode DÃ‰PART) -->
            <div id="config-sms" style="display:none; margin-top: 20px;">
                <p class="info-text" style="color: #FFD700;">ğŸ“ NumÃ©ro du tÃ©lÃ©phone ARRIVÃ‰E :</p>
                <div style="position: relative;">
                    <input type="tel" id="input-tel-arrivee" placeholder="+33612345678" class="input-tel">
                    <span id="tel-saved-indicator" style="display:none; position: absolute; right: 15px; top: 50%; transform: translateY(-50%); color: #00FF00; font-size: 24px; font-weight: 900;">âœ“</span>
                </div>
                <p class="info-text" style="color: #00FF00; font-size: 14px; margin-top: 10px; text-align: center;">
                    ğŸ’¾ Le numÃ©ro est sauvegardÃ© automatiquement
                </p>
            </div>
        </div>

        <!-- Info SMS automatique (Mode ARRIVEE uniquement) -->
        <div id="reception-sms-section" class="mode-app-section" style="display:none;">
            <h2>ğŸ“© RÃ©ception SMS automatique</h2>
            <p class="info-text" style="color: #00FF00; text-align: center; font-size: 20px;">
                âœ… Les SMS de dÃ©part seront reÃ§us automatiquement<br>
                <small style="font-size: 16px; opacity: 0.8;">Assurez-vous que les permissions SMS sont activÃ©es</small>
            </p>
        </div>

        <!-- Liste des dÃ©parts (mode DÃ‰PART uniquement) -->
        <div id="departs-section" class="departs-section" style="display:none;">
            <h2>ğŸš€ DÃ©parts enregistrÃ©s</h2>
            <div id="departs-liste" class="departs-liste">
                <p class="empty-message">Aucun dÃ©part enregistrÃ©</p>
            </div>
        </div>

        <!-- Import de participants -->
        <div class="import-section">
            <h2>ğŸ“‚ Import de participants</h2>
            <p class="info-text">Importez un fichier Excel/OpenOffice avec les colonnes : Nom, Numero</p>
            
            <input type="file" id="file-input" accept=".xlsx,.xls,.ods,.csv" style="display:none">
            <button id="btn-import" class="btn btn-info">ğŸ“¥ Importer fichier</button>
            
            <div id="import-status" class="import-status"></div>
        </div>

        <!-- DÃ©marrer un coureur -->
        <div class="record-section">
            <h2 id="titre-demarrage">ğŸƒ DÃ©marrer un coureur</h2>
            
            <!-- Mode : Liste ou Manuel -->
            <div class="mode-switch">
                <button id="btn-mode-liste" class="mode-btn active">ğŸ“‹ Liste</button>
                <button id="btn-mode-manuel" class="mode-btn">âœï¸ Manuel</button>
            </div>
            
            <!-- Mode Liste -->
            <div id="mode-liste" class="mode-container">
                <div class="form-group">
                    <select id="select-participant" class="select-participant">
                        <option value="">-- SÃ©lectionnez un participant --</option>
                    </select>
                </div>
                <div id="participant-info" class="participant-info"></div>
            </div>
            
            <!-- Mode Manuel -->
            <div id="mode-manuel" class="mode-container" style="display:none">
                <p class="info-text" style="color: #FFD700; font-size: 18px; text-align: center; margin: 20px 0;">
                    âœ… Un dossard sera automatiquement attribuÃ© Ã  chaque dÃ©part
                </p>
            </div>
            
            <button id="btn-demarrer" class="btn btn-success">â–¶ï¸ DÃ©marrer le chrono</button>
        </div>

        <!-- Coureurs actifs -->
        <div class="coureurs-section">
            <h2>ğŸƒâ€â™‚ï¸ Coureurs en course</h2>
            <div id="coureurs-actifs" class="coureurs-actifs">
                <p class="empty-message">Aucun coureur en course</p>
            </div>
        </div>

        <!-- Liste des arrivants -->
        <div class="list-section">
            <div class="list-header">
                <h2>ğŸ† Classement (<span id="count">0</span>/<span id="total">0</span>)</h2>
                <div class="list-actions">
                    <button id="btn-exporter" class="btn btn-small">ğŸ’¾ Exporter</button>
                    <button id="btn-effacer" class="btn btn-small btn-danger">ğŸ—‘ï¸ Effacer</button>
                </div>
            </div>
            
            <div id="liste-arrivants" class="liste-arrivants">
                <p class="empty-message">Aucun arrivant enregistrÃ©</p>
            </div>
        </div>

        <!-- Section Debug -->
  <!--       <div class="mode-app-section" style="margin-top: 30px;">
            <h2>ğŸ”§ Outils de dÃ©bogage</h2>
            <button id="btn-toggle-debug" class="btn btn-info" onclick="ouvrirMenuDebug()">
                ğŸ” Afficher le menu debug
            </button>
        </div>
    </div>   
  -->  
    <!-- BibliothÃ¨que SheetJS pour lire Excel/ODS -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <script src="cordova.js"></script>
    <script src="js/index.js"></script>
</body>
</html>
